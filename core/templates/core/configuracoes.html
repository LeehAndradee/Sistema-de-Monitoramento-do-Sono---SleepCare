{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SleepCase - Configura√ß√µes</title>
    
    <link rel="stylesheet" href="{% static 'core/css/configuracoes.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
</head>
<body class="dashboard-bg"> 
<div id="sleepcase-dashboard">

<header id="navbar">
    <div class="logo">SleepCase</div>

    <nav class="nav-links">
        <a href="{% url 'dashboard' %}" class="{% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">Dashboard</a>
        <a href="{% url 'registrar_sono' %}" class="{% if request.resolver_match.url_name == 'registrar_sono' %}active{% endif %}">Di√°rio de Sono</a>
        <a href="{% url 'dicas_higiene' %}" class="{% if request.resolver_match.url_name == 'dicas_higiene' %}active{% endif %}">Metas & Desafios</a>
        <a href="{% url 'configuracoes' %}" class="{% if request.resolver_match.url_name == 'configuracoes' %}active{% endif %}">Configura√ß√µes</a>
    </nav>

    <div class="user-profile">
        <span class="username">Ol√°, {{ user.first_name|default:user.username }} üåô</span>
        <a href="{% url 'admin:logout' %}" class="logout-btn">Sair</a>
    </div>
</header>

    <main class="content-area">

        <h1>‚öôÔ∏è Configura√ß√µes do Sistema</h1>
        <p class="status-message">Ajuste seu perfil, metas e prefer√™ncias do SleepCase.</p>

        <section class="settings-container">

            <aside class="settings-menu">
                <a href="#" data-section="perfil" class="menu-item active">üë§ Perfil e Conta</a>
                <a href="#" data-section="metas" class="menu-item">üéØ Metas de Sono</a>
                <a href="#" data-section="seguranca" class="menu-item">üîí Seguran√ßa</a>
            </aside>

            <div class="settings-content">

                <article id="perfil" class="config-section active-section">
                    <h2>Perfil e Informa√ß√µes Pessoais</h2>
                    <p>Mantenha seus dados atualizados para relat√≥rios mais precisos.</p>

                    <div class="card settings-card">
                        <form method="post" action="{% url 'configuracoes' %}">
                            {% csrf_token %}

                            <div class="profile-header">
                                <div class="profile-avatar">{{ user.first_name|default:user.username|slice:":1"|upper }}</div>
                                <div class="profile-info">
                                    <label for="id_first_name">Nome Completo</label>
                                    <input type="text" id="id_first_name" name="first_name"
                                           value="{{ user.first_name|default:user.username }}" required>
                                </div>
                            </div>

                            <div class="form-group-row">
                                <div class="form-group">
                                    <label for="email">E-mail (N√£o Edit√°vel)</label>
                                    <input type="email" id="email" value="{{ user.email|default:'N/A' }}" disabled>
                                </div>

                                <div class="form-group">
                                    <label for="nasc">Data de Nascimento (Exemplo)</label>
                                    <input type="date" id="nasc" value="1995-10-20"> 
                                </div>
                            </div>

                            <button type="submit" class="cta-button save-button">
                                Salvar Altera√ß√µes
                            </button>
                        </form>
                    </div>
                </article>

                <article id="metas" class="config-section">
                    <h2>üéØ Defini√ß√£o de Metas de Sono</h2>
                    <p>Defina o n√∫mero ideal de horas que voc√™ deseja dormir por noite.</p>
                    <div class="card settings-card">
                        <form method="post">
                            {% csrf_token %}
                            <div class="form-group">
                                <label for="meta_horas">Meta de Horas de Sono por Noite (em horas)</label>
                                <input type="number" id="meta_horas" name="meta_horas" min="4" max="12" value="8" required>
                            </div>
                            <button type="submit" class="cta-button save-button">Salvar Meta</button>
                        </form>
                    </div>
                </article>

                <article id="notificacoes" class="config-section">
                    <h2>üîî Gerenciar Notifica√ß√µes</h2>
                    <p>Escolha quando e como deseja receber lembretes e alertas.</p>
                    <div class="card settings-card">
                        <div class="form-group checkbox-group">
                            <input type="checkbox" id="lembrete_dormir" checked>
                            <label for="lembrete_dormir">Lembrete para hora de dormir (ex: 22:30)</label>
                        </div>
                        <div class="form-group checkbox-group">
                            <input type="checkbox" id="alerta_baixa_qualidade">
                            <label for="alerta_baixa_qualidade">Alertas de baixa qualidade de sono</label>
                        </div>
                        <button class="cta-button save-button">Salvar Prefer√™ncias</button>
                    </div>
                </article>

                <article id="integracoes" class="config-section">
                    <h2>üîó Integra√ß√µes de Dados</h2>
                    <p>Conecte o SleepCase com outros aplicativos de sa√∫de (futuro).</p>
                    <div class="card settings-card">
                        <p class="status-message">üîå Nenhuma integra√ß√£o dispon√≠vel no momento.</p>
                        <button class="cta-button secondary-button" disabled>Buscar Integra√ß√µes</button>
                    </div>
                </article>

                <article id="seguranca" class="config-section">
                    <h2>üîí Seguran√ßa e Senha</h2>
                    <p>Altere sua senha de acesso ao sistema.</p>
                    <div class="card settings-card">
                        <p>Use o <a href="{% url 'admin:password_change' %}">sistema de troca de senha do Django</a>.</p>
                        <a href="{% url 'admin:password_change' %}" class="cta-button">Trocar Senha</a>
                    </div>
                </article>

                <article id="dados" class="config-section delete-section">
                    <h2>üóëÔ∏è Gerenciar e Exportar Dados</h2>
                    <p>Op√ß√µes para exportar ou excluir todos os seus dados de sono.</p>
                    <div class="card settings-card">
                        <button class="cta-button delete-button">Excluir Todos os Dados de Sono</button>
                        <button class="cta-button secondary-button">Exportar Dados (CSV)</button>
                    </div>
                </article>

            </div>

        </section>

    </main>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const menuItems = document.querySelectorAll('.settings-menu .menu-item');
        const sections = document.querySelectorAll('.settings-content .config-section');

        menuItems.forEach(item => {
            item.addEventListener('click', function(e) {
                e.preventDefault();
                
                // 1. Remove 'active' de todos os itens do menu e das se√ß√µes
                menuItems.forEach(i => i.classList.remove('active'));
                sections.forEach(s => s.classList.remove('active-section'));

                // 2. Adiciona 'active' ao item clicado
                this.classList.add('active');

                // 3. Obt√©m o ID da se√ß√£o alvo e a exibe
                const targetId = this.getAttribute('data-section');
                const targetSection = document.getElementById(targetId);
                
                if (targetSection) {
                    targetSection.classList.add('active-section');
                }

                // Opcional: Atualiza a URL sem recarregar para facilitar o compartilhamento
                // history.pushState(null, '', `#${targetId}`);
            });
        });

        // L√≥gica inicial para garantir que apenas a primeira se√ß√£o esteja vis√≠vel
        // Esta l√≥gica garante que a se√ß√£o 'perfil' (que tem a classe 'active-section' 
        // no HTML) seja a primeira a aparecer.
    });
</script>

</body>
</html>